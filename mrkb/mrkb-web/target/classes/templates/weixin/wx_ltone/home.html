<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
	<head>
		<title>首页</title>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
		<link rel="stylesheet" type="text/css" href="../../css/wx_ltone/weui.min.css" th:href="@{/css/wx_ltone/weui.min.css}"/>
		<link rel="stylesheet" type="text/css" href="../../css/wx_ltone/jquery-weui.css" th:href="@{/css/wx_ltone/jquery-weui.css}"/>
		<link rel="stylesheet" type="text/css" href="../../css/wx_ltone/reset.css" th:href="@{/css/wx_ltone/reset.css}"/>
		<link rel="stylesheet" type="text/css" href="../../css/wx_ltone/home.css" th:href="@{/css/wx_ltone/home.css}"/>
		
	</head>

	<body>
		<div class="ltone-content">
			<!-- 顶部背景图 -->
			<div class="home-top">
				<div class="banner-div-box" id="swiper-wrapper"></div>
				<!-- 紫罗兰公益 -->
				<div class="left-top-btn-box" onclick="window.location = basePath + '/HomeController/fund'">
					<img style="position: relative;left: 15%;top: 25%;" th:src="@{/img/wx_ltone/icon/tabbar/icon-fund.png}">
					<span style="position: absolute;top:45px;width: 100%; font-size: 10px;color:#464646;display: block;text-align: center;">紫罗兰公益</span>
				</div>
				<!-- 知识库 -->
				<div class="left-center-btn-box" onclick="window.location = basePath + '/HomeController/knowledge'">
					<img style="position: relative;left: 21%;top: 25%;" th:src="@{/img/wx_ltone/icon/tabbar/icon-knowledge.png}"/>
					<span style="position: absolute;top:45px;width: 100%; font-size: 10px;color:#464646;display: block;text-align: center;">知识库</span>
				</div>
				<!-- 排行榜 //basePath + '/HomeController/intelligentAngel'-->

				<div class="right-center-btn-box" onclick="window.location = 'https://appet55pMkr2161.h5.xiaoeknow.com'">
					<img style="position: relative;left: 15%;top: 19%;" th:src="@{/img/wx_ltone/icon/tabbar/icon-rankinglist.png}" />
					<span style="position: absolute;top: 45px;width: 100%; font-size: 10px;color:#464646;display: block;text-align: center;">乐学堂/span>
				</div>
				<!-- 紫罗兰发布 -->
				<div class="right-top-btn-box" onclick="window.location = basePath + '/HomeController/video'">
					<img style="position: relative;left: 30%;top: 25%;" th:src="@{/img/wx_ltone/icon/tabbar/icon-video.png}" />
					<span style="position: absolute;top:50px;width: 100%; font-size: 10px;color:#464646;display: block;text-align: center;">紫罗兰发布</span>
				</div>
			</div>

			<!-- 底部背景图 -->
			<div class="home-bottom">
				<div class="home-tip-box">
					<div class="home-tip-content">
						<span>用心成就生命，将快乐传递一亿人</span>
						<span>Enlighten lives with heart, deliver happiness to 100,000,000 people</span>
					</div>
				</div>
			</div>
		</div>
		<div class="weui-tabbar">
			<div class="weui-tabbar__item weui-bar__item--on">
				<div class="weui-tabbar__icon">
					<img th:src="@{/img/wx_ltone/icon/tabbar/icon-home-active.png}">
				</div>
				<p class="weui-tabbar__label">首页</p>
			</div>
			<div onclick="window.location = basePath + '/HomeController/bigFoison'" class="weui-tabbar__item">
				<div class="weui-tabbar__icon">
					<img th:src="@{/img/wx_ltone/icon/tabbar/icon-big-foison.png}">
				</div>
				<p class="weui-tabbar__label">商城</p>
			</div>
			<div onclick="window.location = basePath + '/HomeController/bigGrowUp'" class="weui-tabbar__item">
				<div class="weui-tabbar__icon">
					<img th:src="@{/img/wx_ltone/icon/tabbar/icon-big-grow-up.png}">
				</div>
				<p class="weui-tabbar__label">成长课程</p>
			</div>
			<div onclick="window.location = basePath + '/HomeController/mine'" class="weui-tabbar__item">
				<div class="weui-tabbar__icon">
					<img th:src="@{/img/wx_ltone/icon/tabbar/icon-mine.png}">
				</div>
				<p class="weui-tabbar__label">我的后院</p>
			</div>
		</div>
		
		<script src="../../static/js/wx_ltone/jquery-2.1.4.js" th:src="@{/js/wx_ltone/jquery-2.1.4.js}" ></script>
		<script src="../../static/js/wx_ltone/fastclick.js" th:src="@{/js/wx_ltone/fastclick.js}" ></script>
		<script src="../../static/js/wx_ltone/jquery-weui.js" th:src="@{/js/wx_ltone/jquery-weui.js}" ></script>
		<script src="../../static/js/wx_ltone/swiper.js" th:src="@{/js/wx_ltone/swiper.js}" ></script>
		<script src="../../static/js/wx_ltone/banner.js" th:src="@{/js/wx_ltone/banner.js}"></script>
		<script src="../../static/js/basePathConfig.js" th:src="@{/js/basePathConfig.js}" ></script>
		<script type="text/javascript">
			
			$(function() {
				
				FastClick.attach(document.body);
				//加载动态轮播图
				$.ajax({ 
			    	type : "GET", //提交方式 
			    	url : basePath + '/weixin_news/findNews',
			    	contentType:'application/json',
			    	data : { 
			     		news_type: 6
			    	},//数据，这里使用的是Json格式进行传输 
			    	success : function(result) {
		      			if(result.data){
		      				var dataArr = [];
			      			for(var i = 0; i < result.data.length; i++){
			      				var bannerData = { news_id: result.data[i].news_id, news_picture: result.data[i].news_picture.split(';')[0]}
			      				dataArr.push(bannerData);
			      			}
			      			bannerClick(document.getElementById('swiper-wrapper'),dataArr,false);
		      			}
			    	},
		     		error: function (err){
			     		$.toast('网络错误，请稍后重试...');
			     		return;
		     		}
			    });
				// 提交问卷
				$.ajax({
					type : "GET", //提交方式 
					url : basePath + '/user_weixin/selectUserInformationEntityToUserId',
					data : {
					}, //数据，这里使用的是Json格式进行传输 
					success : function(result) {
						//alert(result.data.information_compellation);
						if(result.data.information_compellation==null||result.data.information_compellation==""){
							//window.location.href=basePath + '/HomeController/questionnaire';
						}
						
					},
					error : function(err) {
						$.toast('提交失败!');
						return;
					}
				});
			});
			
			/**
			 * 动态加载点击的轮播图
			 */
			function bannerClick(elementObj,data,indicator){
				var sliderDiv = document.createElement('div');
					sliderDiv.className = 'swiper-container swiper-container-horizontal';
					elementObj.appendChild(sliderDiv);
				
				// 图片层
				var sliderGroup = document.createElement('div');
					sliderGroup.className = 'swiper-wrapper';
					sliderDiv.appendChild(sliderGroup);
				
				var html = '';
				for (var i = 0; i < data.length + 2; i++) {
					if (i == 0) {
						html += '<div class="swiper-slide swiper-slide-duplicate">' +
								'	<a href="javascript:void(0);" onclick="showPage('+ data[data.length - 1].news_id +');">' +
								'		<img src="' + data[data.length - 1].news_picture + '" onerror="javascript:this.src=\'http://via.placeholder.com/200X200\'">' +
								'	</a>' +
								'</div>';
					} else if (i == data.length + 1) {
						html += '<div class="swiper-slide swiper-slide-duplicate">' +
								'	<a href="javascript:void(0);" onclick="showPage('+ data[0].news_id +');">' +
								'		<img src="'+ data[0].news_picture +'" onerror="javascript:this.src=\'http://via.placeholder.com/200X200\'">' +
								'	</a>' +
								'</div>';
					} else {
						var k = i - 1;
						html += '<div class="swiper-slide">' +
								'	<a href="javascript:void(0);" onclick="showPage('+ data[k].news_id +');">' +
								'		<img src="' + data[k].news_picture + '" onerror="javascript:this.src=\'http://via.placeholder.com/200X200\'">' +
								'	</a>' +
								'</div>';
					}
				}
				sliderGroup.innerHTML = html;
				// 判断是否需要加载小圆点
				if(indicator){
					// 图片下面的圆点
					var sliderIndicator = document.createElement('div');
					sliderIndicator.className = 'swiper-pagination swiper-pagination-bullets';
					sliderDiv.appendChild(sliderIndicator);
					var indicatorHTML = '';
					for (var j = 0; j < data.length; j++) {
						if (j == 0) {
							indicatorHTML += '<span class="swiper-pagination-bullet swiper-pagination-bullet-active"></span>';
						} else {
							indicatorHTML += '<span class="swiper-pagination-bullet"></span>';
						}
					}
					sliderIndicator.innerHTML = indicatorHTML;
				}
				$(".swiper-container").swiper({
					loop: true,
					autoplay: 3000
				});
			} 
			
			function showPage(news_id){
				window.location = basePath+"/HomeController/indexRollImgDetail?news_id="+news_id
			}
		</script>
	</body>
</html>
