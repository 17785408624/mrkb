<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
	<head>
		<title>知识库</title>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
		
		<link rel="stylesheet" type="text/css" href="../../css/wx_ltone/weui.min.css" th:href="@{/css/wx_ltone/weui.min.css}"/>
		<link rel="stylesheet" type="text/css" href="../../css/wx_ltone/jquery-weui.css" th:href="@{/css/wx_ltone/jquery-weui.css}"/>
		<link rel="stylesheet" type="text/css" href="../../css/wx_ltone/reset.css" th:href="@{/css/wx_ltone/reset.css}"/>
		<link rel="stylesheet" type="text/css" href="../../css/wx_ltone/mainstyle.css" th:href="@{/css/wx_ltone/mainstyle.css}" />
		<link rel="stylesheet" type="text/css" href="../../css/wx_ltone/public.css" th:href="@{/css/wx_ltone/public.css}" />
		<link rel="stylesheet" type="text/css" href="../../css/wx_ltone/knowledge.css" th:href="@{/css/wx_ltone/knowledge.css}" />
	</head>

	<body>
		<div class="search border-blue">
			<div class="search-left mui-action-back">
				<a href="javascript:void(0);" onclick="toBack('/HomeController/home');">
					<img th:src="@{/img/wx_ltone/icon/mine/fanhui.png}">
				</a>
			</div>
			<div class="title_div">
				<div class="title_div_li" onclick="clickShowDiv(this,'knowledgeList');">
					<span style="border-bottom:2px solid #fff;padding-bottom:8px;">成长</span>
				</div>
				<div class="title_div_li" onclick="clickShowDiv(this,'relation');">
					<span>关系</span>
				</div>
				<div class="title_div_li" onclick="clickShowDiv(this,'riches');">
					<span>财富</span>
				</div>
				<div class="title_div_li" onclick="clickShowDiv(this,'company');">
					<span>企业</span>
				</div>
			</div>
		</div>
		<div class="list kbsj_div_ul konwledge" id="knowledgeList"></div>
		<div class="list kbsj_div_ul" id="relation" style="display: none;"></div>
		<div class="list kbsj_div_ul" id="riches" style="display: none;"></div>
		<div class="list kbsj_div_ul" id="company" style="display: none;"></div>
		<script src="../../static/js/wx_ltone/jquery-2.1.4.js" th:src="@{/js/wx_ltone/jquery-2.1.4.js}" ></script>
		<script src="../../static/js/wx_ltone/fastclick.js" th:src="@{/js/wx_ltone/fastclick.js}" ></script>
		<script src="../../static/js/wx_ltone/jquery-weui.js" th:src="@{/js/wx_ltone/jquery-weui.js}" ></script>
		<script src="../../static/js/wx_ltone/common.js" th:src="@{/js/wx_ltone/common.js}" ></script>
		<script src="../../static/js/basePathConfig.js" th:src="@{/js/basePathConfig.js}" ></script>
		<script>
			
			//返回上级
			function toBack(path){
				if (window.history && window.history.pushState) {
			   		$(window).on('popstate', function () {
			      		window.history.pushState('forward', window.location = basePath + path, '#');
			        });
			    }
			    window.history.pushState('forward', window.location = basePath + path, '#'); 
			}
			var  newsType = 11;//新闻类型
			$(function() {
				FastClick.attach(document.body);
				//alert(newsType);
				// 获取知识列表
				$.ajax({ 
			    	type : "GET", //提交方式 
			    	url : basePath + '/weixin_news/findNews',
			    	data : { 
			     		news_type: newsType
			    	},//数据，这里使用的是Json格式进行传输 
			    	success : function(result) {
		      			fillKnowledgeList(result.data,"#knowledgeList")
			    	},
		     		error: function (err){
			     		$.toast('网络错误，请稍后重试...');
			     		return;
		     		}
			    });
			});
			
			// 填充知识列表
			function fillKnowledgeList(data,id){
			 $(id).html('');
			///alert(id);
				if(data != ''){
					var htmlStr = '';
					for(var i = 0; i < data.length; i++){
						htmlStr = '<div class="default-text-color list-box" onclick="window.location =\''+ basePath + '/HomeController/knowledgeDetail?news_id='+ data[i].news_id +'&news_type='+ data[i].news_type +'\'">'+
								  '	<h4>'+ data[i].news_title +'</h4>'+
								  '	<img src="'+ data[i].news_picture.split(";")[0] +'" onerror="javascript:this.src=\'http://via.placeholder.com/360X150\'">'+
								  '	<div class="position-relative intro-box">'+
								  '		<label class="intro-data">'+ formatDateTimeStr(data[i].add_date,0) +'</label>'+
								  '		<label class="intro-options">'+
								  '			<span class="intro">'+
								  '				<img class="icon-yueduliang" src="/morekaba/img/wx_ltone/icon/mine/chakan.png"/>&nbsp;&nbsp;'+
								  '				<span>'+ data[i].read_num +'</span>'+
								  '			</span>'+
								  '			<span class="intro">'+
								  '				<img class="icon-zan" src="/morekaba/img/wx_ltone/icon/mine/dianzan.png"/>&nbsp;&nbsp;'+
								  '				<span>'+ data[i].thumbs_up +'</span>'+
								  '			</span>'+
								  '		</label>'+
								  '	</div>'+
								  '</div>';
						$(id).append(htmlStr);
					}
				}else{
					$.alert('暂无数据');
					return;
				}
			}
			function clickShowDiv(e,id){
				//菜单切换
				$(".kbsj_div_ul").each(function(){
				 //  $(this).removeClass('konwledge').addClass('list kbsj_div_ul');
					if($(this).attr("id")==id){
					 //alert($(this).attr("id"));
					 if($(this).attr("id")=="knowledgeList"){
					 	newsType=11;
					 }else if($(this).attr("id")=="relation"){
					 	newsType=12;
					 }else if($(this).attr("id")=="riches"){
					 	newsType=13;
					 }else if($(this).attr("id")=="company"){
					 	newsType=14;
					 } 
						$(this).show();
						$(function() {
				FastClick.attach(document.body);
				//alert(newsType);
				// 获取知识列表
				$.ajax({ 
			    	type : "GET", //提交方式 
			    	url : basePath + '/weixin_news/findNews',
			    	data : { 
			     		news_type: newsType
			    	},//数据，这里使用的是Json格式进行传输 
			    	success : function(result) {
		      			fillKnowledgeList(result.data,"#"+id);
			    	},
		     		error: function (err){
			     		$.toast('网络错误，请稍后重试...');
			     		return;
		     		}
			    });
			});
						
					}else{
						$(this).hide();
					}
				});
				$(e).children("span").css({
					"border-bottom":"2px solid #fff",
					"padding-bottom":"8px"
				});
				$(e).siblings().each(function(){
					if($(this).attr("class")=="title_div_li"){
						$(this).children("span").css({
							"border-bottom":"none",
							"padding-bottom":"8px"
						});
					}
				});
			}
		</script>
	</body>
</html>
